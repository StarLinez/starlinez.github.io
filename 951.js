"use strict";(self.webpackChunkRandomProject=self.webpackChunkRandomProject||[]).push([[951],{62951:(O,h,n)=>{n.r(h),n.d(h,{MaplestoryTrackerWeeklyModule:()=>b});var c=n(60177),g=n(66859),e=n(54438),p=n(345),d=n(59292),m=n(60813),f=n(65658),k=n(96784),y=n(62708),v=n(29576),C=n(63721),T=n(51267);function u(r,o){1&r&&e.nrm(0,"app-error-box")}function D(r,o){if(1&r){const t=e.RV6();e.j41(0,"app-info-box",6),e.bIt("dismissEvent",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.infoChangeHandler())}),e.k0s()}if(2&r){const t=e.XpG();e.Y8G("title",t.generalData.trackerInfo.weeklyInfoTitle)("text",t.generalData.trackerInfo.weeklyInfoText)}}function S(r,o){if(1&r&&(e.j41(0,"div",10)(1,"span"),e.EFF(2),e.k0s()()),2&r){const t=e.XpG(2);e.R7$(2),e.JRh("Weekly Bosses Reset in "+t.timerStrings[0])}}function M(r,o){if(1&r&&(e.j41(0,"div",10)(1,"span"),e.EFF(2),e.k0s()()),2&r){const t=e.XpG(2);e.R7$(2),e.JRh("Monday Tasks Reset in "+t.timerStrings[1])}}function R(r,o){if(1&r&&(e.j41(0,"div",10)(1,"span"),e.EFF(2),e.k0s()()),2&r){const t=e.XpG(2);e.R7$(2),e.JRh("Thursday Tasks Reset in "+t.timerStrings[2])}}function x(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",7),e.DNE(1,S,3,1,"div",8)(2,M,3,1,"div",8)(3,R,3,1,"div",8),e.j41(4,"app-task-group",9),e.bIt("changeEvent",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.changeHandler())}),e.k0s()()}if(2&r){const t=o.$implicit,a=e.XpG();e.R7$(),e.Y8G("ngIf","Weekly Bosses"===t.title),e.R7$(),e.Y8G("ngIf","Monday Reset"===t.title),e.R7$(),e.Y8G("ngIf","Thursday Reset"===t.title),e.R7$(),e.Y8G("editMode",a.editMode)("taskGroup",t)("imagePrefix",a.generalData.trackerInfo.weeklyImagePrefix)("resetUtcOffset",a.generalData.mapleRegion.resetUtcOffset)}}const I=[{path:"",component:(()=>{class r{constructor(t,a,i,s){this.titleService=t,this.metaService=a,this.generalDataService=i,this.taskService=s,this.initialisationComplete=!1,this.timers=[],this.timerStrings=["","",""],this.editMode=!1}ngOnInit(){this.titleService.setTitle("Maplestory Dailies Tracker | Random Stuff"),this.metaService.updateTag({name:"description",content:"A weeklies tracker for Maplestory to keep track of your completed weekly tasks. Keep track of your weeklies across multiple different characters."}),this.metaService.getTag("name='robots'")?this.metaService.updateTag({name:"robots",content:"index, follow"}):this.metaService.addTag({name:"robots",content:"index, follow"}),this.initialise()}ngOnDestroy(){}initialise(){localStorage.getItem("generalData")?(this.generalData=JSON.parse(localStorage.getItem("generalData")),this.taskService.weeklyUpdateChecker(this.generalData),this.weeklyResetChecker(),this.fetchSelectedUserData()):(this.generalData=this.generalDataService.initiateDataSet(),this.fetchSelectedUserData()),this.startTimer(0),this.startTimer(1),this.initialisationComplete=!0}fetchSelectedUserData(){this.selectedCharacter=localStorage.getItem(this.generalData.characters[this.generalData.selectedCharacterIndex].characterStorageReference)?JSON.parse(localStorage.getItem(this.generalData.characters[this.generalData.selectedCharacterIndex].characterStorageReference)):this.generalDataService.addCharacterWithExistingReference(this.generalData.characters[this.generalData.selectedCharacterIndex].characterStorageReference)}weeklyResetChecker(){var t=this.calculateResetDayTime(4)-6048e5,a=this.calculateResetDayTime(1)-6048e5,i=parseInt(this.generalData.trackerInfo.lastWeeklyTrackerVisit);i<t&&(this.taskService.resetWeeklyCompletionIndex(this.generalData,0),this.taskService.resetWeeklyCompletionIndex(this.generalData,2)),i<a&&this.taskService.resetWeeklyCompletionIndex(this.generalData,1),this.generalData.trackerInfo.lastWeeklyTrackerVisit=Date.now().toString(),this.generalDataChangeHandler()}startTimer(t){var a;clearInterval(this.timers[t]),a=this.calculateResetDayTime(1==t?1:4),this.calculateAndOutPutTimes(a-(new Date).getTime(),t),this.timers[t]=setInterval(()=>{var i=a-(new Date).getTime();this.calculateAndOutPutTimes(i,t),i<0&&(clearInterval(this.timers[t]),this.liveReset(t))},1e3)}calculateResetDayTime(t){var a=new Date,i=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),0,0,0,0));i.setTime(i.getTime()+24*((7+t-i.getUTCDay()-1)%7+1)*60*60*1e3);var s=i.valueOf();return(s-=60*this.generalData.mapleRegion.resetUtcOffset*60*1e3)<a.getTime()&&(s+=6048e5),s}calculateAndOutPutTimes(t,a){if(t<0)return this.timerStrings[a]="RESET!",void(0==a&&(this.timerStrings[2]="RESET!"));var i=Math.floor(t/864e5),s=Math.floor(t%864e5/36e5),l=Math.floor(t%36e5/6e4),w=Math.floor(t%6e4/1e3);this.timerStrings[a]=i+"d "+s+"h "+l+"m "+("00"+w).slice(-2)+"s ",0==a&&(this.timerStrings[2]=this.timerStrings[a])}liveReset(t){this.taskService.resetWeeklyCompletionIndex(this.generalData,t),0==t&&this.taskService.resetWeeklyCompletionIndex(this.generalData,2),this.startTimer(t),this.generalData.trackerInfo.lastWeeklyTrackerVisit=(parseInt(Date.now().toString())+5e3).toString(),this.changeHandler()}addCharacter(t){this.generalDataService.addCharacter(this.generalData,t)}switchCharacter(t){this.generalData.selectedCharacterIndex=t,this.generalDataChangeHandler(),this.fetchSelectedUserData()}changeHandler(){localStorage.setItem(this.generalData.characters[this.generalData.selectedCharacterIndex].characterStorageReference,JSON.stringify(this.selectedCharacter))}editModeChange(t){this.editMode=t}generalDataChangeHandler(){localStorage.setItem("generalData",JSON.stringify(this.generalData))}infoChangeHandler(){this.generalData.trackerInfo.weeklyInfoVisible=!1,this.generalDataChangeHandler()}regionChangeHandler(){this.weeklyResetChecker(),this.startTimer(0),this.startTimer(1),this.generalDataChangeHandler()}static{this.\u0275fac=function(a){return new(a||r)(e.rXU(p.hE),e.rXU(p.W8),e.rXU(d.K),e.rXU(m.R))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-maplestory-tracker-weekly"]],decls:8,vars:5,consts:[[4,"ngIf"],[3,"title","text","dismissEvent",4,"ngIf"],[1,"background"],[3,"generalData","editMode","editModeChangeEvent","addCharacterEvent","switchCharacterEvent","regionChangeEvent"],[1,"taskWrapper"],["class","groupWrapper",4,"ngFor","ngForOf"],[3,"title","text","dismissEvent"],[1,"groupWrapper"],["class","timer",4,"ngIf"],[3,"editMode","taskGroup","imagePrefix","resetUtcOffset","changeEvent"],[1,"timer"]],template:function(a,i){1&a&&(e.DNE(0,u,1,0,"app-error-box",0)(1,D,1,2,"app-info-box",1),e.nrm(2,"app-maplestory-navigation")(3,"div",2),e.j41(4,"app-task-titlebar",3),e.bIt("editModeChangeEvent",function(l){return i.editModeChange(l)})("addCharacterEvent",function(l){return i.addCharacter(l)})("switchCharacterEvent",function(l){return i.switchCharacter(l)})("regionChangeEvent",function(){return i.regionChangeHandler()}),e.k0s(),e.nrm(5,"app-tracker-navigation"),e.j41(6,"div",4),e.DNE(7,x,5,7,"div",5),e.k0s()),2&a&&(e.Y8G("ngIf",!i.initialisationComplete),e.R7$(),e.Y8G("ngIf",i.generalData.trackerInfo.weeklyInfoVisible),e.R7$(3),e.Y8G("generalData",i.generalData)("editMode",i.editMode),e.R7$(3),e.Y8G("ngForOf",i.selectedCharacter.weeklyTaskGroups))},dependencies:[c.Sq,c.bT,f.O,k.c,y.C,v.Q,C.F,T.H],styles:[".background[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-10;filter:blur(8px);-webkit-filter:blur(8px);background-image:url(TrackerBackground.jpg);background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll}.timer[_ngcontent-%COMP%]{width:425px;height:30px;background-color:#393939;border-radius:6px;margin-bottom:20px;font-size:15px;font-weight:500;font-family:Lemon Milk,sans-serif;text-align:center}.timer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;padding-top:5px}.taskWrapper[_ngcontent-%COMP%]{width:1375px;margin:0 auto;display:-webkit-flexbox;display:flex;flex-flow:row wrap;-webkit-flex-pack:justify;justify-content:space-between}"]})}}return r})()}];let W=(()=>{class r{static{this.\u0275fac=function(a){return new(a||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[g.iI.forChild(I),g.iI]})}}return r})();var E=n(67436),_=n(38574);let b=(()=>{class r{static{this.\u0275fac=function(a){return new(a||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[c.MD,W,E.E,_.K]})}}return r})()}}]);