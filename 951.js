"use strict";(self.webpackChunkRandomProject=self.webpackChunkRandomProject||[]).push([[951],{62951:(R,p,i)=>{i.r(p),i.d(p,{MaplestoryTrackerWeeklyModule:()=>b});var l=i(60177),h=i(66859),e=i(54438),g=i(345),d=i(59292),m=i(60813),f=i(65658),k=i(96784),u=i(62708),C=i(29576),v=i(63721),y=i(51267),D=i(93843);function T(n,c){1&n&&e.nrm(0,"app-error-box")}function M(n,c){if(1&n){const t=e.RV6();e.j41(0,"app-info-box",8),e.bIt("dismissEvent",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.infoChangeHandler())}),e.k0s()}if(2&n){const t=e.XpG();e.Y8G("title",t.generalData.trackerInfo.weeklyInfoTitle)("text",t.generalData.trackerInfo.weeklyInfoText)}}function x(n,c){if(1&n){const t=e.RV6();e.j41(0,"div",9)(1,"app-task-group",10),e.bIt("changeEvent",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.changeHandler())}),e.k0s()()}if(2&n){const t=c.$implicit,a=e.XpG();e.R7$(),e.Y8G("editMode",a.editMode)("taskGroup",t)("imagePrefix",a.generalData.trackerInfo.weeklyImagePrefix)("resetUtcOffset",a.generalData.mapleRegion.resetUtcOffset)}}const S=[{path:"",component:(()=>{class n{constructor(t,a,r,s){this.titleService=t,this.metaService=a,this.generalDataService=r,this.taskService=s,this.initialisationComplete=!1,this.editMode=!1}ngOnInit(){this.titleService.setTitle("Maplestory Dailies Tracker | Random Stuff"),this.metaService.updateTag({name:"description",content:"A weeklies tracker for Maplestory to keep track of your completed weekly tasks. Keep track of your weeklies across multiple different characters."}),this.metaService.getTag("name='robots'")?this.metaService.updateTag({name:"robots",content:"index, follow"}):this.metaService.addTag({name:"robots",content:"index, follow"}),this.initialise()}ngOnDestroy(){}initialise(){localStorage.getItem("generalData")?(this.generalData=JSON.parse(localStorage.getItem("generalData")),this.taskService.weeklyUpdateChecker(this.generalData),this.weeklyResetChecker(),this.fetchSelectedUserData()):(this.generalData=this.generalDataService.initiateDataSet(),this.fetchSelectedUserData()),this.startTimer(),this.initialisationComplete=!0}fetchSelectedUserData(){this.selectedCharacter=localStorage.getItem(this.generalData.characters[this.generalData.selectedCharacterIndex].characterStorageReference)?JSON.parse(localStorage.getItem(this.generalData.characters[this.generalData.selectedCharacterIndex].characterStorageReference)):this.generalDataService.addCharacterWithExistingReference(this.generalData.characters[this.generalData.selectedCharacterIndex].characterStorageReference)}weeklyResetChecker(){var t=this.calculateResetTime()-6048e5;parseInt(this.generalData.trackerInfo.lastWeeklyTrackerVisit)<t&&this.taskService.resetWeeklyCompletion(this.generalData),this.generalData.trackerInfo.lastWeeklyTrackerVisit=Date.now().toString(),this.generalDataChangeHandler()}startTimer(){clearInterval(this.timer);var t=this.calculateResetTime();this.calculateAndOutPutTime(t-(new Date).getTime()),this.timer=setInterval(()=>{var a=t-(new Date).getTime();this.calculateAndOutPutTime(a),a<0&&(clearInterval(this.timer),this.liveReset())},1e3)}calculateResetTime(){var t=new Date,a=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),0,0,0,0));a.setTime(a.getTime()+24*((11-a.getUTCDay()-1)%7+1)*60*60*1e3);var r=a.valueOf();return(r-=60*this.generalData.mapleRegion.resetUtcOffset*60*1e3)<t.getTime()&&(r+=6048e5),r}calculateAndOutPutTime(t){if(t<0)this.timerString="RESET!";else{var a=Math.floor(t/864e5),r=Math.floor(t%864e5/36e5),s=Math.floor(t%36e5/6e4),o=Math.floor(t%6e4/1e3);this.timerString="Weekly reset in "+a+"d "+r+"h "+s+"m "+("00"+o).slice(-2)+"s "}}liveReset(){this.taskService.resetWeeklyCompletion(this.generalData),this.startTimer(),this.generalData.trackerInfo.lastWeeklyTrackerVisit=(parseInt(Date.now().toString())+5e3).toString(),this.generalDataChangeHandler(),this.fetchSelectedUserData()}addCharacter(t){this.generalDataService.addCharacter(this.generalData,t)}switchCharacter(t){this.generalData.selectedCharacterIndex=t,this.generalDataChangeHandler(),this.fetchSelectedUserData()}changeHandler(){localStorage.setItem(this.generalData.characters[this.generalData.selectedCharacterIndex].characterStorageReference,JSON.stringify(this.selectedCharacter))}editModeChange(t){this.editMode=t}generalDataChangeHandler(){localStorage.setItem("generalData",JSON.stringify(this.generalData))}infoChangeHandler(){this.generalData.trackerInfo.weeklyInfoVisible=!1,this.generalDataChangeHandler()}regionChangeHandler(){this.weeklyResetChecker(),this.startTimer(),this.generalDataChangeHandler()}static{this.\u0275fac=function(a){return new(a||n)(e.rXU(g.hE),e.rXU(g.W8),e.rXU(d.K),e.rXU(m.R))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-maplestory-tracker-weekly"]],decls:13,vars:6,consts:[[4,"ngIf"],[3,"title","text","dismissEvent",4,"ngIf"],[1,"background"],[3,"generalData","editMode","editModeChangeEvent","addCharacterEvent","switchCharacterEvent","regionChangeEvent"],[1,"timerWrapper"],[1,"timer"],[1,"taskWrapper"],["class","taskGroupWrapper",4,"ngFor","ngForOf"],[3,"title","text","dismissEvent"],[1,"taskGroupWrapper"],[1,"taskGroupTest",3,"editMode","taskGroup","imagePrefix","resetUtcOffset","changeEvent"]],template:function(a,r){1&a&&(e.DNE(0,T,1,0,"app-error-box",0)(1,M,1,2,"app-info-box",1),e.nrm(2,"app-maplestory-navigation")(3,"div",2),e.j41(4,"app-task-titlebar",3),e.bIt("editModeChangeEvent",function(o){return r.editModeChange(o)})("addCharacterEvent",function(o){return r.addCharacter(o)})("switchCharacterEvent",function(o){return r.switchCharacter(o)})("regionChangeEvent",function(){return r.regionChangeHandler()}),e.k0s(),e.nrm(5,"app-tracker-navigation"),e.j41(6,"div",4)(7,"div",5)(8,"span"),e.EFF(9),e.k0s()()(),e.j41(10,"div",6),e.DNE(11,x,2,4,"div",7),e.k0s(),e.nrm(12,"app-footer")),2&a&&(e.Y8G("ngIf",!r.initialisationComplete),e.R7$(),e.Y8G("ngIf",r.generalData.trackerInfo.weeklyInfoVisible&&r.initialisationComplete),e.R7$(3),e.Y8G("generalData",r.generalData)("editMode",r.editMode),e.R7$(5),e.JRh(r.timerString),e.R7$(2),e.Y8G("ngForOf",r.selectedCharacter.weeklyTaskGroups))},dependencies:[l.Sq,l.bT,f.O,k.c,u.C,C.Q,v.F,y.H,D.n],styles:[".background[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-10;filter:blur(8px);-webkit-filter:blur(8px);background-image:url(TrackerBackground.jpg);background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll}.timerWrapper[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center}.timer[_ngcontent-%COMP%]{width:1375px;height:30px;background-color:#393939;border-radius:6px;font-size:15px;font-weight:500;font-family:Lemon Milk,sans-serif;color:#fff;text-align:center}.timer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;padding-top:5px}.taskWrapper[_ngcontent-%COMP%]{width:1375px;margin:20px auto 0;display:-webkit-flexbox;display:flex;flex-flow:row wrap;-webkit-flex-pack:justify;justify-content:space-between}@media only screen and (max-width: 1400px){.timerWrapper[_ngcontent-%COMP%]{width:900px;margin:0 auto 20px}.taskWrapper[_ngcontent-%COMP%]{width:950px;display:block;margin:0 auto}.taskGroupWrapper[_ngcontent-%COMP%]{display:block;float:left;margin:0 25px}}@media only screen and (max-width: 953px){.timerWrapper[_ngcontent-%COMP%]{width:425px;margin:0 auto 20px}.taskWrapper[_ngcontent-%COMP%]{width:425px}.taskGroupWrapper[_ngcontent-%COMP%]{display:block;float:none;margin:0 auto}}"]})}}return n})()}];let I=(()=>{class n{static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[h.iI.forChild(S),h.iI]})}}return n})();var w=i(67436),W=i(38574);let b=(()=>{class n{static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[l.MD,I,w.E,W.K]})}}return n})()}}]);